<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: spring | 小毛的胡思乱想]]></title>
  <link href="http://mccxj.github.com/blog/categories/spring/atom.xml" rel="self"/>
  <link href="http://mccxj.github.com/"/>
  <updated>2016-09-10T00:14:54+08:00</updated>
  <id>http://mccxj.github.com/</id>
  <author>
    <name><![CDATA[蔡晓建]]></name>
    <email><![CDATA[mc02cxj@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[websphere+spring+jndi数据源配置]]></title>
    <link href="http://mccxj.github.com/blog/20140329_was-datasource.html"/>
    <updated>2014-03-29T00:00:00+08:00</updated>
    <id>http://mccxj.github.com/blog/was-datasource</id>
    <content type="html"><![CDATA[<p>配置的步骤在下面简要说明:</p>

<ol>
<li>增加基于spring的jndi数据源配置</li>
<li>在websphere上增加数据源配置</li>
<li>链接iiop地址</li>
</ol>


<p>下面进行详细描述。</p>

<ul>
<li>基于spring的jndi配置文件</li>
</ul>


<p>注意:如果是第二种方式，可以忽略第三部分"链接iiop地址"</p>

<p>第一种方式:</p>

<p>```diff
&lt;?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xmlns:aop="http://www.springframework.org/schema/aop"
 xmlns:tx="http://www.springframework.org/schema/tx"
 xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd           http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd"></p>

<ul>
<li>&lt;bean id="GlobalConfig"</li>
<li><pre><code>class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt;
</code></pre></li>
<li><pre><code>&lt;property name="systemPropertiesMode"&gt;
</code></pre></li>
<li><pre><code>    &lt;value&gt;1&lt;/value&gt;
</code></pre></li>
<li><pre><code>&lt;/property&gt;
</code></pre></li>
<li><pre><code>&lt;property name="searchSystemEnvironment"&gt;
</code></pre></li>
<li><pre><code>    &lt;value&gt;true&lt;/value&gt;
</code></pre></li>
<li><pre><code>&lt;/property&gt;
</code></pre></li>
<li><pre><code>&lt;property name="ignoreUnresolvablePlaceholders"&gt;
</code></pre></li>
<li><pre><code>    &lt;value&gt;true&lt;/value&gt;
</code></pre></li>
<li><pre><code>&lt;/property&gt;
</code></pre></li>
<li><p></bean></p></li>
<li><p> <bean id="jtaTransactionManager" class="org.springframework.transaction.jta.WebSphereUowTransactionManager" />
 &lt;tx:annotation-driven transaction-manager="jtaTransactionManager"  proxy-target-class="true" />
 <bean id="lobHandler" class="org.springframework.jdbc.support.lob.DefaultLobHandler"/></p></li>
<li><p><bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean"></p></li>
<li><pre><code>&lt;property name="jndiName"&gt;&lt;value&gt;XXX&lt;/value&gt;&lt;/property&gt;
</code></pre></li>
<li><pre><code>&lt;property name="resourceRef"&gt;&lt;value&gt;true&lt;/value&gt;&lt;/property&gt;
</code></pre></li>
<li><pre><code>&lt;property name="jndiEnvironment"&gt;&lt;props&gt;&lt;prop key="java.naming.provider.url"&gt;${java_naming_provider_url}&lt;/prop&gt;&lt;/props&gt;&lt;/property&gt;
</code></pre></li>
<li><p></bean><br/>
</beans>
```</p></li>
<li><p>在websphere上增加数据源配置</p></li>
</ul>


<p><img src="/assets/images/2014/ds.png" alt="效果图" /></p>

<ul>
<li>链接iiop地址</li>
</ul>


<p>在server的java进程定义里边配置jvm参数:  -Djava_naming_provider_url=iiop://localhost:port/,另外，修改启动参数需要重启server才能生效。</p>

<p><img src="/assets/images/2014/iiop.png" alt="效果图" /></p>

<p>其中每个server的port都是不一样的，具体的端口通过Application servers - serverX - Communications -  Ports上查看，如下图:</p>

<p><img src="/assets/images/2014/port.png" alt="效果图" /></p>
]]></content>
  </entry>
  
</feed>
